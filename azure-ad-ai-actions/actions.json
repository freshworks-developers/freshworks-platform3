{
  "resetPassword": {
    "display_name": "Reset User Password",
    "description": "Reset a user's password in Azure AD with optional force change on next sign-in",
    "parameters": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "type": "object",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The ID or userPrincipalName of the user whose password needs to be reset"
        },
        "newPassword": {
          "type": "string",
          "description": "The new password for the user"
        },
        "forceChangePasswordNextSignIn": {
          "type": "boolean",
          "description": "Whether to force the user to change password on next sign-in"
        }
      },
      "required": [
        "userId",
        "newPassword"
      ]
    },
    "response": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean",
          "description": "Whether the password reset was successful"
        },
        "userId": {
          "type": "string",
          "description": "The ID of the user whose password was reset"
        },
        "message": {
          "type": "string",
          "description": "Response message"
        }
      },
      "required": [
        "success"
      ]
    }
  },
  "searchUser": {
    "display_name": "Search User",
    "description": "Search for users in Azure AD by email, display name, or user principal name",
    "parameters": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "type": "object",
      "properties": {
        "searchQuery": {
          "type": "string",
          "description": "Search query to find users by email, display name, or user principal name"
        },
        "filter": {
          "type": "string",
          "description": "Optional OData filter expression (e.g., accountEnabled eq true)"
        },
        "top": {
          "type": "number",
          "description": "Maximum number of results to return (default: 10)"
        }
      },
      "required": [
        "searchQuery"
      ]
    },
    "response": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "type": "object",
      "properties": {
        "users": {
          "type": "array",
          "description": "List of matching users",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "description": "User ID"
              },
              "userPrincipalName": {
                "type": "string",
                "description": "User principal name"
              },
              "displayName": {
                "type": "string",
                "description": "Display name"
              },
              "mail": {
                "type": "string",
                "description": "Email address"
              },
              "accountEnabled": {
                "type": "boolean",
                "description": "Whether the account is enabled"
              }
            },
            "required": [
              "id"
            ]
          }
        },
        "count": {
          "type": "number",
          "description": "Number of users found"
        }
      },
      "required": [
        "users",
        "count"
      ]
    }
  },
  "unlockAccount": {
    "display_name": "Unlock Account",
    "description": "Unlock a locked Azure AD user account by enabling it",
    "parameters": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "type": "object",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The ID or userPrincipalName of the user account to unlock"
        }
      },
      "required": [
        "userId"
      ]
    },
    "response": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "type": "object",
      "properties": {
        "success": {
          "type": "boolean",
          "description": "Whether the account unlock was successful"
        },
        "userId": {
          "type": "string",
          "description": "The ID of the user account that was unlocked"
        },
        "message": {
          "type": "string",
          "description": "Response message"
        }
      },
      "required": [
        "success"
      ]
    }
  }
}
